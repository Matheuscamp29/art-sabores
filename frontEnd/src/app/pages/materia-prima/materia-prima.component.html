<div class="container mx-auto p-4">
  <h1 class="text-2xl font-bold mb-4">Matérias Primas</h1>

  <button 
    (click)="toggleFormulario()"
    class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mb-4"
  >
    {{ mostrarFormulario ? 'Cancelar' : 'Adicionar Matéria Prima' }}
  </button>

  <div *ngIf="mostrarFormulario" class="mb-6">
    <form [formGroup]="materiaPrimaForm" (ngSubmit)="salvarMateriaPrima()" class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
      <div class="mb-4">
        <label class="block text-gray-700 text-sm font-bold mb-2" for="nome">
          Nome
        </label>
        <input 
          formControlName="nome"
          id="nome" 
          type="text" 
          placeholder="Nome da matéria prima"
          class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
        >
        <div *ngIf="materiaPrimaForm.get('nome')?.invalid && materiaPrimaForm.get('nome')?.touched" class="text-red-500 text-xs italic">
          Nome é obrigatório.
        </div>
      </div>

      <div class="mb-4">
        <label class="block text-gray-700 text-sm font-bold mb-2" for="unidadeMedida">
          Unidade de Medida
        </label>
        <select 
          formControlName="unidadeMedida"
          id="unidadeMedida"
          class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
        >
          <option value="">Selecione</option>
          <option value="kg">Quilograma (kg)</option>
          <option value="g">Grama (g)</option>
          <option value="l">Litro (l)</option>
          <option value="ml">Mililitro (ml)</option>
          <option value="un">Unidade (un)</option>
        </select>
        <div *ngIf="materiaPrimaForm.get('unidadeMedida')?.invalid && materiaPrimaForm.get('unidadeMedida')?.touched" class="text-red-500 text-xs italic">
          Unidade de medida é obrigatória.
        </div>
      </div>

      <div class="mb-4">
        <label class="block text-gray-700 text-sm font-bold mb-2" for="quantidadeMinima">
          Quantidade Mínima
        </label>
        <input 
          formControlName="quantidadeMinima"
          id="quantidadeMinima" 
          type="number" 
          min="0"
          class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
        >
        <div *ngIf="materiaPrimaForm.get('quantidadeMinima')?.invalid && materiaPrimaForm.get('quantidadeMinima')?.touched" class="text-red-500 text-xs italic">
          Quantidade mínima deve ser um número não negativo.
        </div>
      </div>

      <div class="mb-4">
        <label class="block text-gray-700 text-sm font-bold mb-2" for="fornecedorId">
          Fornecedor
        </label>
        <select 
          formControlName="fornecedorId"
          id="fornecedorId"
          class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
        >
          <option value="">Selecione um fornecedor</option>
          <option *ngFor="let fornecedor of fornecedores" [value]="fornecedor.id">{{ fornecedor.nome }}</option>
        </select>
        <div *ngIf="materiaPrimaForm.get('fornecedorId')?.invalid && materiaPrimaForm.get('fornecedorId')?.touched" class="text-red-500 text-xs italic">
          Fornecedor é obrigatório.
        </div>
      </div>

      <div class="flex items-center justify-between">
        <button 
          type="submit"
          [disabled]="materiaPrimaForm.invalid"
          class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline disabled:bg-green-300"
        >
          Salvar
        </button>
        <button 
          type="button"
          (click)="cancelarFormulario()"
          class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
        >
          Cancelar
        </button>
      </div>
    </form>
  </div>

  <div *ngIf="itens.length === 0" class="text-gray-600">
    Nenhuma matéria prima cadastrada.
  </div>

  <div *ngIf="itens.length > 0">
    <table class="min-w-full table-auto">
      <thead class="bg-gray-200">
        <tr>
          <th class="px-4 py-2">Nome</th>
          <th class="px-4 py-2">Unidade</th>
          <th class="px-4 py-2">Qtd. Mínima</th>
          <th class="px-4 py-2">Fornecedor</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of itens">
          <td class="border px-4 py-2">{{ item.nome }}</td>
          <td class="border px-4 py-2">{{ item.unidadeMedida }}</td>
          <td class="border px-4 py-2">{{ item.quantidadeMinima }}</td>
          <td class="border px-4 py-2">{{ item.fornecedorNome || 'N/A' }}</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>